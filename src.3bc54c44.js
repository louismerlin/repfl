parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function N(a){return a&&a.__esModule?{d:a.default}:{d:a}}var ma,na,b,oa,f,O,P,Q,pa,g={},w=[],R=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function j(r,o){for(var e in o)r[e]=o[e];return r}function z(r){var o=r.parentNode;o&&o.removeChild(r)}function d(r,o,e){var t,$,n,a,l=arguments;if(o=j({},o),arguments.length>3)for(e=[e],t=3;t<arguments.length;t++)e.push(l[t]);if(null!=e&&(o.children=e),null!=r&&null!=r.defaultProps)for($ in r.defaultProps)void 0===o[$]&&(o[$]=r.defaultProps[$]);return a=o.key,null!=(n=o.ref)&&delete o.ref,null!=a&&delete o.key,i(r,o,a,n)}function i(r,o,e,t){var $={type:r,props:o,key:e,ref:t,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return b.vnode&&b.vnode($),$}function k(r){return r.children}function S(r){if(null==r||"boolean"==typeof r)return null;if("string"==typeof r||"number"==typeof r)return i(null,r,null,null);if(null!=r.__e||null!=r.__c){var o=i(r.type,r.props,r.key,null);return o.__e=r.__e,o}return r}function q(r,o){this.props=r,this.context=o}function m(r,o){if(null==o)return r.__p?m(r.__p,r.__p.__k.indexOf(r)+1):null;for(var e;o<r.__k.length;o++)if(null!=(e=r.__k[o])&&null!=e.__e)return e.__e;return"function"==typeof r.type?m(r):null}function u(r){var o,e;if(null!=(r=r.__p)&&null!=r.__c){for(r.__e=r.__c.base=null,o=0;o<r.__k.length;o++)if(null!=(e=r.__k[o])&&null!=e.__e){r.__e=r.__c.base=e.__e;break}return u(r)}}function l(r){(!r.__d&&(r.__d=!0)&&1===f.push(r)||P!==b.debounceRendering)&&(P=b.debounceRendering,(b.debounceRendering||O)(T))}function T(){var r,o,e,t,$,n,a,l;for(f.sort(function(r,o){return o.__v.__b-r.__v.__b});r=f.pop();)r.__d&&(e=void 0,t=void 0,n=($=(o=r).__v).__e,a=o.__P,l=o.u,o.u=!1,a&&(e=[],t=x(a,$,j({},$),o.__n,void 0!==a.ownerSVGElement,null,e,l,null==n?m($):n),D(e,$),t!=n&&u($)))}function A(r,o,e,t,$,n,a,l,p){var _,i,u,s,S,c,v,f=e&&e.__k||w,d=f.length;if(l==g&&(l=null!=n?n[0]:d?m(e,0):null),_=0,o.__k=y(o.__k,function(e){if(null!=e){if(e.__p=o,e.__b=o.__b+1,null===(u=f[_])||u&&e.key==u.key&&e.type===u.type)f[_]=void 0;else for(i=0;i<d;i++){if((u=f[i])&&e.key==u.key&&e.type===u.type){f[i]=void 0;break}u=null}if(s=x(r,e,u=u||g,t,$,n,a,null,l,p),(i=e.ref)&&u.ref!=i&&(v||(v=[])).push(i,e.__c||s,e),null!=s){if(null==c&&(c=s),null!=e.l)s=e.l,e.l=null;else if(n==u||s!=l||null==s.parentNode){r:if(null==l||l.parentNode!==r)r.appendChild(s);else{for(S=l,i=0;(S=S.nextSibling)&&i<d;i+=2)if(S==s)break r;r.insertBefore(s,l)}"option"==o.type&&(r.value="")}l=s.nextSibling,"function"==typeof o.type&&(o.l=s)}}return _++,e}),o.__e=c,null!=n&&"function"!=typeof o.type)for(_=n.length;_--;)null!=n[_]&&z(n[_]);for(_=d;_--;)null!=f[_]&&F(f[_],f[_]);if(v)for(_=0;_<v.length;_++)E(v[_],v[++_],v[++_])}function y(r,o,e){if(null==e&&(e=[]),null==r||"boolean"==typeof r)o&&e.push(o(null));else if(Array.isArray(r))for(var t=0;t<r.length;t++)y(r[t],o,e);else e.push(o?o(S(r)):r);return e}function U(r,o,e,t,$){var n;for(n in e)n in o||B(r,n,null,e[n],t);for(n in o)$&&"function"!=typeof o[n]||"value"===n||"checked"===n||e[n]===o[n]||B(r,n,o[n],e[n],t)}function v(r,o,e){"-"===o[0]?r.setProperty(o,e):r[o]="number"==typeof e&&!1===R.test(o)?e+"px":null==e?"":e}function B(r,o,e,t,$){var n,a,l,p,_;if("key"===(o=$?"className"===o?"class":o:"class"===o?"className":o)||"children"===o);else if("style"===o){if(n=r.style,"string"==typeof e)n.cssText=e;else{if("string"==typeof t&&(n.cssText="",t=null),t)for(a in t)e&&a in e||v(n,a,"");if(e)for(l in e)t&&e[l]===t[l]||v(n,l,e[l])}}else"o"===o[0]&&"n"===o[1]?(p=o!==(o=o.replace(/Capture$/,"")),_=o.toLowerCase(),o=(_ in r?_:o).slice(2),e?(t||r.addEventListener(o,C,p),(r.t||(r.t={}))[o]=e):r.removeEventListener(o,C,p)):"list"!==o&&"tagName"!==o&&"form"!==o&&!$&&o in r?r[o]=null==e?"":e:"function"!=typeof e&&"dangerouslySetInnerHTML"!==o&&(o!==(o=o.replace(/^xlink:?/,""))?null==e||!1===e?r.removeAttributeNS("http://www.w3.org/1999/xlink",o.toLowerCase()):r.setAttributeNS("http://www.w3.org/1999/xlink",o.toLowerCase(),e):null==e||!1===e?r.removeAttribute(o):r.setAttribute(o,e))}function C(r){return this.t[r.type](b.event?b.event(r):r)}function x(r,o,e,t,$,n,a,l,p,_){var i,u,s,S,c,v,f,d,x,h,m=o.type;if(void 0!==o.constructor)return null;(i=b.__b)&&i(o);try{r:if("function"==typeof m){if(d=o.props,x=(i=m.contextType)&&t[i.__c],h=i?x?x.props.value:i.__p:t,e.__c?f=(u=o.__c=e.__c).__p=u.__E:("prototype"in m&&m.prototype.render?o.__c=u=new m(d,h):(o.__c=u=new q(d,h),u.constructor=m,u.render=W),x&&x.sub(u),u.props=d,u.state||(u.state={}),u.context=h,u.__n=t,s=u.__d=!0,u.__h=[]),null==u.__s&&(u.__s=u.state),null!=m.getDerivedStateFromProps&&j(u.__s==u.state?u.__s=j({},u.__s):u.__s,m.getDerivedStateFromProps(d,u.__s)),s)null==m.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&a.push(u);else{if(null==m.getDerivedStateFromProps&&null==l&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(d,h),!l&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(d,u.__s,h)){for(u.props=d,u.state=u.__s,u.__d=!1,u.__v=o,o.__e=null!=p?p!==e.__e?p:e.__e:null,o.__k=e.__k,i=0;i<o.__k.length;i++)o.__k[i]&&(o.__k[i].__p=o);break r}null!=u.componentWillUpdate&&u.componentWillUpdate(d,u.__s,h)}for(S=u.props,c=u.state,u.context=h,u.props=d,u.state=u.__s,(i=b.__r)&&i(o),u.__d=!1,u.__v=o,u.__P=r,i=u.render(u.props,u.state,u.context),o.__k=y(null!=i&&i.type==k&&null==i.key?i.props.children:i),null!=u.getChildContext&&(t=j(j({},t),u.getChildContext())),s||null==u.getSnapshotBeforeUpdate||(v=u.getSnapshotBeforeUpdate(S,c)),A(r,o,e,t,$,n,a,p,_),u.base=o.__e;i=u.__h.pop();)u.__s&&(u.state=u.__s),i.call(u);s||null==S||null==u.componentDidUpdate||u.componentDidUpdate(S,c,v),f&&(u.__E=u.__p=null)}else o.__e=V(e.__e,o,e,t,$,n,a,_);(i=b.diffed)&&i(o)}catch(r){b.__e(r,o,e)}return o.__e}function D(r,o){for(var e;e=r.pop();)try{e.componentDidMount()}catch(r){b.__e(r,e.__v)}b.__c&&b.__c(o)}function V(r,o,e,t,$,n,a,l){var p,_,i,u,s=e.props,S=o.props;if($="svg"===o.type||$,null==r&&null!=n)for(p=0;p<n.length;p++)if(null!=(_=n[p])&&(null===o.type?3===_.nodeType:_.localName===o.type)){r=_,n[p]=null;break}if(null==r){if(null===o.type)return document.createTextNode(S);r=$?document.createElementNS("http://www.w3.org/2000/svg",o.type):document.createElement(o.type),n=null}return null===o.type?s!==S&&(null!=n&&(n[n.indexOf(r)]=null),r.data=S):o!==e&&(null!=n&&(n=w.slice.call(r.childNodes)),i=(s=e.props||g).dangerouslySetInnerHTML,u=S.dangerouslySetInnerHTML,l||(u||i)&&(u&&i&&u.__html==i.__html||(r.innerHTML=u&&u.__html||"")),U(r,S,s,$,l),o.__k=o.props.children,u||A(r,o,e,t,"foreignObject"!==o.type&&$,n,a,g,l),l||("value"in S&&void 0!==S.value&&S.value!==r.value&&(r.value=null==S.value?"":S.value),"checked"in S&&void 0!==S.checked&&S.checked!==r.checked&&(r.checked=S.checked))),r}function E(r,o,e){try{"function"==typeof r?r(o):r.current=o}catch(r){b.__e(r,e)}}function F(r,o,e){var t,$,n;if(b.unmount&&b.unmount(r),(t=r.ref)&&E(t,null,o),e||"function"==typeof r.type||(e=null!=($=r.__e)),r.__e=r.l=null,null!=(t=r.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(r){b.__e(r,o)}t.base=t.__P=null}if(t=r.__k)for(n=0;n<t.length;n++)t[n]&&F(t[n],o,e);null!=$&&z($)}function W(r,o,e){return this.constructor(r,e)}function X(r,o,e){var t,$,n;b.__p&&b.__p(r,o),$=(t=e===Q)?null:e&&e.__k||o.__k,r=d(k,null,[r]),n=[],x(o,t?o.__k=r:(e||o).__k=r,$||g,g,void 0!==o.ownerSVGElement,e&&!t?[e]:$?null:w.slice.call(o.childNodes),n,!1,e||g,t),D(n,r)}na=b={},ma=oa=function(r){return null!=r&&void 0===r.constructor},q.prototype.setState=function(r,o){var e=this.__s!==this.state&&this.__s||(this.__s=j({},this.state));("function"!=typeof r||(r=r(e,this.props)))&&j(e,r),null!=r&&this.__v&&(this.u=!1,o&&this.__h.push(o),l(this))},q.prototype.forceUpdate=function(r){this.__v&&(r&&this.__h.push(r),this.u=!0,l(this))},q.prototype.render=k,f=[],O="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,P=b.debounceRendering,b.__e=function(r,o,e){for(var t;o=o.__p;)if((t=o.__c)&&!t.__p)try{if(t.constructor&&null!=t.constructor.getDerivedStateFromError)t.setState(t.constructor.getDerivedStateFromError(r));else{if(null==t.componentDidCatch)continue;t.componentDidCatch(r)}return l(t.__E=t)}catch(o){r=o}throw r},Q=g,pa=0;var o,a,e=[],r=b.__r;b.__r=function($){r&&r($),o=0,(a=$.__c).__H&&(a.__H.t=n(a.__H.t))};var t=b.diffed;b.diffed=function($){t&&t($);var r=$.__c;if(r){var e=r.__H;e&&(e.u=(e.u.some(function($){$.ref&&($.ref.current=$.createHandle())}),[]),e.i=n(e.i))}};var G=b.unmount;function H($){b.__h&&b.__h(a);var r=a.__H||(a.__H={o:[],t:[],i:[],u:[]});return $>=r.o.length&&r.o.push({}),r.o[$]}function p($){return Y(I,$)}function Y($,r,e){var t=H(o++);return t.__c||(t.__c=a,t.v=[e?e(r):I(void 0,r),function(r){var e=$(t.v[0],r);t.v[0]!==e&&(t.v[0]=e,t.__c.setState({}))}]),t.v}function Z($,r){var e=H(o++);ea(e.m,r)&&(e.v=$,e.m=r,a.__H.t.push(e),_(a))}b.unmount=function($){G&&G($);var r=$.__c;if(r){var e=r.__H;e&&e.o.forEach(function($){return $.l&&$.l()})}};var _=function(){};function aa(){e.some(function($){$.s=!1,$.__P&&($.__H.t=n($.__H.t))}),e=[]}if("undefined"!=typeof window){var ba=b.requestAnimationFrame;_=function($){(!$.s&&($.s=!0)&&1===e.push($)||ba!==b.requestAnimationFrame)&&(ba=b.requestAnimationFrame,(b.requestAnimationFrame||function($){var r=function(){clearTimeout(e),cancelAnimationFrame(t),setTimeout($)},e=setTimeout(r,100),t=requestAnimationFrame(r)})(aa))}}function n($){return $.forEach(ca),$.forEach(da),[]}function ca($){$.l&&$.l()}function da($){var r=$.v();"function"==typeof r&&($.l=r)}function ea($,r){return!$||r.some(function(r,e){return r!==$[e]})}function I($,r){return"function"==typeof r?r($):r}function J(e,t){return new Error(e+" "+t.status+" "+t.responseText)}var fa=function(e,t){return new Promise(function(r,n){var o=t&&t.method||"GET",a=t&&t.body||null,s=t&&t.type||null,u=t&&t.headers||{};e||n(new Error("No url was given"));var p=new XMLHttpRequest;p.open(o,e,!0),a instanceof FormData||"form-data"===s?p.setRequestHeader("Content-Type","multipart/form-data"):null!==a&&"object"==typeof a||"json"===s?("object"==typeof a&&(a=JSON.stringify(a)),p.setRequestHeader("Content-Type","application/json")):p.setRequestHeader("Content-Type",s||"application/x-www-form-urlencoded"),Object.keys(u).forEach(function(e){p.setRequestHeader(e,u[e])}),p.onload=function(){if(p.status>=200&&p.status<400)try{var e=JSON.parse(p.responseText);r(e)}catch(t){r(p.responseText)}else n(J("Server returned:",p))},p.onerror=function(){n(J("Connection error:",p))},p.send(a)})};const c=new Date,ga="https://cors.louis.workers.dev?apiurl=",K="https://ewa.epfl.ch/room/Default.aspx?room=",L=new Intl.DateTimeFormat("ch-fr",{hour:"2-digit",minute:"2-digit"}).format,ha=new Date(c.getTime()+864e5),ia=36e5,ja=96e4;function h(e){return new Date(e+"+02:00")}function ka({name:e,loaded:$}){const[r,t]=p({isLoading:!0,freeUntil:null,occupiedUntil:null});Z(()=>{!async function(){const r=await fa(`${ga}${K}${e}`);if($(),!r||!r.length)return;const a=r.split("\n").find(e=>e.includes("v.events"));if(!a||void 0===a)return t({isLoading:!1,error:!0});const n=a.replace("v.events = ","").replace(/;/g,"").replace(/\\"/g,"").replace(/<br>/g,"").replace(/ISA - /g,"").replace(/\\/g,""),i=JSON.parse(n),o=i.reduce((e,{Start:$,End:r,Text:t})=>{const a=h($),n=h(r);if(e){const n=new Date(e.End);return new Date(n.getUTCMilliseconds()+ja)>a?{Start:$,End:r,Text:t}:e}if(c>a&&c<n)return{Start:$,End:r,Text:t}},null),f=i.find(({Start:e})=>{const $=h(e);return c<$&&$<ha}),l=!o&&f&&h(f.Start),M=o&&h(o.End),s=o&&"R\xE9servation ponctuelle"===o.Text||f&&"R\xE9servation ponctuelle"===f.Text;t({isLoading:!1,freeUntil:l,occupiedUntil:M,isReservationPonctuelle:s})}()},[]);let a="loading",n="\uD83D\uDD04";return r.isLoading||(a="",n="\uD83D\uDC4D",r.error?(n="\uD83E\uDD37\u200D\u2640\uFE0F",a="Could not load information"):r.isReservationPonctuelle?(a="available for revisions",n="\uD83D\uDC69\u200D\uD83C\uDFEB"):r.freeUntil?(a=`available until ${L(r.freeUntil)}`,r.freeUntil-c.getTime()<=ia&&(n="\u23F3")):r.occupiedUntil&&(a=`occupied until ${L(r.occupiedUntil)}`,n="\u26D4")),d("tr",null,d("td",null,n),d("td",null,d("strong",null,d("a",{target:"_blank",rel:"noopener noreferrer",href:`${K}${e}`},e.toUpperCase()))),d("td",{class:"text-right fullwidth"},a))}var $={};$={in:["inm10","inm11","inm200","inm201","inm202","inm203","inr113","inr219","inf119","inf211","inf213","inf1","inf2","inf3","inj218"],bc:["bc01","bc02","bc03","bc04","bc05","bc010","bc129","bc229","bc329","bc410","bc420"],co:["co020","co021","co023"]};var s=N($);const M=Object.keys(s.d);function la(){const[o,$]=p("all");let[r,m]=p(0);const e=Object.values(s.d).reduce((o,$)=>o+$.length,0),t=()=>{m(r+=1)},c=r===e?{opacity:"0"}:{};return d("main",{class:"container"},d("header",{class:"header"},d("h1",{class:"less-margin title text-center"},"rEPFL"),d("h3",{class:"less-margin subtitle text-center"},"find a free room @ EPFL")),d("progress",{class:"rooms-progress",value:r||"0",max:e,style:c},r,"/",e),d("p",{class:"button-list"},["all"].concat(M).map(r=>d(k,{key:r},d("button",{onClick:()=>$(r),class:o===r?"filled":""},r.toUpperCase())," "))),M.map($=>d("div",{key:$,class:"all"!==o&&o!==$&&"hidden"},d("h2",{class:"text-center table-h2"},$.toUpperCase()),d("hr",{class:"table-hr"}),d("table",null,d("tbody",null,s.d[$].map(o=>d(ka,{key:o,name:o,loaded:t})))))),d("footer",{class:"footer"},d("hr",null),d("h5",{class:"less-margin"},"made with \u2764\uFE0F by ",d("a",{href:"https://louismerl.in"},"Louis Merlin")),d("h5",{class:"less-margin"},"using ",d("a",{href:"https://preactjs.com"},"preact")," and ",d("a",{href:"https://concrete.style"},"concrete.css")),d("h5",{class:"less-margin"},"need more rooms ? ",d("a",{href:"https://github.com/louismerlin/repfl/blob/master/src/rooms.json"},"add them")," or ",d("a",{href:"mailto:louis.merlin@epfl.ch"},"email me")),d("h5",{class:"less-margin"},"don't hesitate to ",d("a",{href:"https://github.com/louismerlin/repfl"},"star and/or contribute"))))}X(d(la,null),document.body);return{"Focm":{}};});