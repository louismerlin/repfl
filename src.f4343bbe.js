parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function N(a){return a&&a.__esModule?{d:a.default}:{d:a}}var ma,na,b,oa,e,O,P,Q,pa,g={},w=[],R=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function j(o,e){for(var t in e)o[t]=e[t];return o}function y(o){var e=o.parentNode;e&&e.removeChild(o)}function d(o,e,t){var $,n,r,a,l=arguments;if(e=j({},e),arguments.length>3)for(t=[t],$=3;$<arguments.length;$++)t.push(l[$]);if(null!=t&&(e.children=t),null!=o&&null!=o.defaultProps)for(n in o.defaultProps)void 0===e[n]&&(e[n]=o.defaultProps[n]);return a=e.key,null!=(r=e.ref)&&delete e.ref,null!=a&&delete e.key,f(o,e,a,r)}function f(o,e,t,$){var n={type:o,props:e,key:t,ref:$,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return b.vnode&&b.vnode(n),n}function k(o){return o.children}function S(o){if(null==o||"boolean"==typeof o)return null;if("string"==typeof o||"number"==typeof o)return f(null,o,null,null);if(null!=o.__e||null!=o.__c){var e=f(o.type,o.props,o.key,null);return e.__e=o.__e,e}return o}function q(o,e){this.props=o,this.context=e}function m(o,e){if(null==e)return o.__p?m(o.__p,o.__p.__k.indexOf(o)+1):null;for(var t;e<o.__k.length;e++)if(null!=(t=o.__k[e])&&null!=t.__e)return t.__e;return"function"==typeof o.type?m(o):null}function p(o){var e,t;if(null!=(o=o.__p)&&null!=o.__c){for(o.__e=o.__c.base=null,e=0;e<o.__k.length;e++)if(null!=(t=o.__k[e])&&null!=t.__e){o.__e=o.__c.base=t.__e;break}return p(o)}}function r(o){(!o.__d&&(o.__d=!0)&&1===e.push(o)||P!==b.debounceRendering)&&(P=b.debounceRendering,(b.debounceRendering||O)(T))}function T(){var o;for(e.sort(function(o,e){return e.__v.__b-o.__v.__b});o=e.pop();)o.__d&&o.forceUpdate(!1)}function z(o,e,t,$,n,r,a,l,p){var _,i,u,s,S,c,v,f=t&&t.__k||w,d=f.length;if(l==g&&(l=null!=r?r[0]:d?m(t,0):null),_=0,e.__k=A(e.__k,function(t){if(null!=t){if(t.__p=e,t.__b=e.__b+1,null===(u=f[_])||u&&t.key==u.key&&t.type===u.type)f[_]=void 0;else for(i=0;i<d;i++){if((u=f[i])&&t.key==u.key&&t.type===u.type){f[i]=void 0;break}u=null}if(s=x(o,t,u=u||g,$,n,r,a,null,l,p),(i=t.ref)&&u.ref!=i&&(v||(v=[])).push(i,t.__c||s,t),null!=s){if(null==c&&(c=s),null!=t.l)s=t.l,t.l=null;else if(r==u||s!=l||null==s.parentNode){o:if(null==l||l.parentNode!==o)o.appendChild(s);else{for(S=l,i=0;(S=S.nextSibling)&&i<d;i+=2)if(S==s)break o;o.insertBefore(s,l)}"option"==e.type&&(o.value="")}l=s.nextSibling,"function"==typeof e.type&&(e.l=s)}}return _++,t}),e.__e=c,null!=r&&"function"!=typeof e.type)for(_=r.length;_--;)null!=r[_]&&y(r[_]);for(_=d;_--;)null!=f[_]&&D(f[_],f[_]);if(v)for(_=0;_<v.length;_++)C(v[_],v[++_],v[++_])}function A(o,e,t){if(null==t&&(t=[]),null==o||"boolean"==typeof o)e&&t.push(e(null));else if(Array.isArray(o))for(var $=0;$<o.length;$++)A(o[$],e,t);else t.push(e?e(S(o)):o);return t}function U(o,e,t,$,n){var r;for(r in t)r in e||u(o,r,null,t[r],$);for(r in e)n&&"function"!=typeof e[r]||"value"===r||"checked"===r||t[r]===e[r]||u(o,r,e[r],t[r],$)}function s(o,e,t){"-"===e[0]?o.setProperty(e,t):o[e]="number"==typeof t&&!1===R.test(e)?t+"px":t||""}function u(o,e,t,$,n){var r,a,l,p,_;if("key"===(e=n?"className"===e?"class":e:"class"===e?"className":e)||"children"===e);else if("style"===e){if(r=o.style,"string"==typeof t)r.cssText=t;else{if("string"==typeof $&&(r.cssText="",$=null),$)for(a in $)t&&a in t||s(r,a,"");if(t)for(l in t)$&&t[l]===$[l]||s(r,l,t[l])}}else"o"===e[0]&&"n"===e[1]?(p=e!==(e=e.replace(/Capture$/,"")),_=e.toLowerCase(),e=(_ in o?_:e).slice(2),t?($||o.addEventListener(e,v,p),(o.u||(o.u={}))[e]=t):o.removeEventListener(e,v,p)):"list"!==e&&"tagName"!==e&&"form"!==e&&!n&&e in o?o[e]=null==t?"":t:"function"!=typeof t&&"dangerouslySetInnerHTML"!==e&&(e!==(e=e.replace(/^xlink:?/,""))?null==t||!1===t?o.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):o.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),t):null==t||!1===t?o.removeAttribute(e):o.setAttribute(e,t))}function v(o){return this.u[o.type](b.event?b.event(o):o)}function x(o,e,t,$,n,r,a,l,p,_){var i,u,s,S,c,v,f,d,x,h,m=e.type;if(void 0!==e.constructor)return null;(i=b.__b)&&i(e);try{o:if("function"==typeof m){if(d=e.props,x=(i=m.contextType)&&$[i.__c],h=i?x?x.props.value:i.__p:$,t.__c?f=(u=e.__c=t.__c).__p=u.__E:("prototype"in m&&m.prototype.render?e.__c=u=new m(d,h):(e.__c=u=new q(d,h),u.constructor=m,u.render=W),x&&x.sub(u),u.props=d,u.state||(u.state={}),u.context=h,u.__n=$,s=u.__d=!0,u.__h=[]),null==u.__s&&(u.__s=u.state),null!=m.getDerivedStateFromProps&&j(u.__s==u.state?u.__s=j({},u.__s):u.__s,m.getDerivedStateFromProps(d,u.__s)),s)null==m.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&a.push(u);else{if(null==m.getDerivedStateFromProps&&null==l&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(d,h),!l&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(d,u.__s,h)){for(u.props=d,u.state=u.__s,u.__d=!1,u.__v=e,e.__e=null!=p?p!==t.__e?p:t.__e:null,e.__k=t.__k,i=0;i<e.__k.length;i++)e.__k[i]&&(e.__k[i].__p=e);break o}null!=u.componentWillUpdate&&u.componentWillUpdate(d,u.__s,h)}for(S=u.props,c=u.state,u.context=h,u.props=d,u.state=u.__s,(i=b.__r)&&i(e),u.__d=!1,u.__v=e,u.__P=o,i=u.render(u.props,u.state,u.context),e.__k=null!=i&&i.type==k&&null==i.key?i.props.children:i,null!=u.getChildContext&&($=j(j({},$),u.getChildContext())),s||null==u.getSnapshotBeforeUpdate||(v=u.getSnapshotBeforeUpdate(S,c)),z(o,e,t,$,n,r,a,p,_),u.base=e.__e;i=u.__h.pop();)u.__s&&(u.state=u.__s),i.call(u);s||null==S||null==u.componentDidUpdate||u.componentDidUpdate(S,c,v),f&&(u.__E=u.__p=null)}else e.__e=V(t.__e,e,t,$,n,r,a,_);(i=b.diffed)&&i(e)}catch(o){b.__e(o,e,t)}return e.__e}function B(o,e){for(var t;t=o.pop();)try{t.componentDidMount()}catch(o){b.__e(o,t.__v)}b.__c&&b.__c(e)}function V(o,e,t,$,n,r,a,l){var p,_,i,u,s=t.props,S=e.props;if(n="svg"===e.type||n,null==o&&null!=r)for(p=0;p<r.length;p++)if(null!=(_=r[p])&&(null===e.type?3===_.nodeType:_.localName===e.type)){o=_,r[p]=null;break}if(null==o){if(null===e.type)return document.createTextNode(S);o=n?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type),r=null}return null===e.type?s!==S&&(null!=r&&(r[r.indexOf(o)]=null),o.data=S):e!==t&&(null!=r&&(r=w.slice.call(o.childNodes)),i=(s=t.props||g).dangerouslySetInnerHTML,u=S.dangerouslySetInnerHTML,l||(u||i)&&(u&&i&&u.__html==i.__html||(o.innerHTML=u&&u.__html||"")),U(o,S,s,n,l),e.__k=e.props.children,u||z(o,e,t,$,"foreignObject"!==e.type&&n,r,a,g,l),l||("value"in S&&void 0!==S.value&&S.value!==o.value&&(o.value=null==S.value?"":S.value),"checked"in S&&void 0!==S.checked&&S.checked!==o.checked&&(o.checked=S.checked))),o}function C(o,e,t){try{"function"==typeof o?o(e):o.current=e}catch(o){b.__e(o,t)}}function D(o,e,t){var $,n,r;if(b.unmount&&b.unmount(o),($=o.ref)&&C($,null,e),t||"function"==typeof o.type||(t=null!=(n=o.__e)),o.__e=o.l=null,null!=($=o.__c)){if($.componentWillUnmount)try{$.componentWillUnmount()}catch(o){b.__e(o,e)}$.base=$.__P=null}if($=o.__k)for(r=0;r<$.length;r++)$[r]&&D($[r],e,t);null!=n&&y(n)}function W(o,e,t){return this.constructor(o,t)}function X(o,e,t){var $,n,r;b.__p&&b.__p(o,e),n=($=t===Q)?null:t&&t.__k||e.__k,o=d(k,null,[o]),r=[],x(e,$?e.__k=o:(t||e).__k=o,n||g,g,void 0!==e.ownerSVGElement,t&&!$?[t]:n?null:w.slice.call(e.childNodes),r,!1,t||g,$),B(r,o)}na=b={},ma=oa=function(o){return null!=o&&void 0===o.constructor},q.prototype.setState=function(o,e){var t=this.__s!==this.state&&this.__s||(this.__s=j({},this.state));("function"!=typeof o||(o=o(t,this.props)))&&j(t,o),null!=o&&this.__v&&(e&&this.__h.push(e),r(this))},q.prototype.forceUpdate=function(o){var e,t,$,n=this.__v,r=this.__v.__e,a=this.__P;a&&(e=!1!==o,t=[],$=x(a,n,j({},n),this.__n,void 0!==a.ownerSVGElement,null,t,e,null==r?m(n):r),B(t,n),$!=r&&p(n)),o&&o()},q.prototype.render=k,e=[],O="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,P=b.debounceRendering,b.__e=function(o,e,t){for(var $;e=e.__p;)if(($=e.__c)&&!$.__p)try{if($.constructor&&null!=$.constructor.getDerivedStateFromError)$.setState($.constructor.getDerivedStateFromError(o));else{if(null==$.componentDidCatch)continue;$.componentDidCatch(o)}return r($.__E=$)}catch(e){o=e}throw o},Q=g,pa=0;var o,a,t=[],E=b.__r;b.__r=function($){E&&E($),o=0,(a=$.__c).__H&&(a.__H.t=l(a.__H.t))};var F=b.diffed;b.diffed=function($){F&&F($);var r=$.__c;if(r){var e=r.__H;e&&(e.u=(e.u.some(function($){$.ref&&($.ref.current=$.createHandle())}),[]),e.i=l(e.i))}};var G=b.unmount;function H($){b.__h&&b.__h(a);var r=a.__H||(a.__H={o:[],t:[],i:[],u:[]});return $>=r.o.length&&r.o.push({}),r.o[$]}function i($){return Y(I,$)}function Y($,r,e){var t=H(o++);return t.__c||(t.__c=a,t.v=[e?e(r):I(null,r),function(r){var e=$(t.v[0],r);t.v[0]!==e&&(t.v[0]=e,t.__c.setState({}))}]),t.v}function Z($,r){var e=H(o++);ea(e.l,r)&&(e.v=$,e.l=r,a.__H.t.push(e),_(a))}b.unmount=function($){G&&G($);var r=$.__c;if(r){var e=r.__H;e&&e.o.forEach(function($){return $.p&&$.p()})}};var _=function(){};function aa(){t.some(function($){$.s=!1,$.__P&&($.__H.t=l($.__H.t))}),t=[]}if("undefined"!=typeof window){var ba=b.requestAnimationFrame;_=function($){(!$.s&&($.s=!0)&&1===t.push($)||ba!==b.requestAnimationFrame)&&(ba=b.requestAnimationFrame,(b.requestAnimationFrame||function($){var r=function(){clearTimeout(e),cancelAnimationFrame(t),setTimeout($)},e=setTimeout(r,100),t=requestAnimationFrame(r)})(aa))}}function l($){return $.forEach(ca),$.forEach(da),[]}function ca($){$.p&&$.p()}function da($){var r=$.v();"function"==typeof r&&($.p=r)}function ea($,r){return!$||r.some(function(r,e){return r!==$[e]})}function I($,r){return"function"==typeof r?r($):r}function J(e,t){return new Error(e+" "+t.status+" "+t.responseText)}var fa=function(e,t){return new Promise(function(r,n){var o=t&&t.method||"GET",a=t&&t.body||null,s=t&&t.type||null,u=t&&t.headers||{};e||n(new Error("No url was given"));var p=new XMLHttpRequest;p.open(o,e,!0),a instanceof FormData||"form-data"===s?p.setRequestHeader("Content-Type","multipart/form-data"):null!==a&&"object"==typeof a||"json"===s?("object"==typeof a&&(a=JSON.stringify(a)),p.setRequestHeader("Content-Type","application/json")):p.setRequestHeader("Content-Type",s||"application/x-www-form-urlencoded"),Object.keys(u).forEach(function(e){p.setRequestHeader(e,u[e])}),p.onload=function(){if(p.status>=200&&p.status<400)try{var e=JSON.parse(p.responseText);r(e)}catch(t){r(p.responseText)}else n(J("Server returned:",p))},p.onerror=function(){n(J("Connection error:",p))},p.send(a)})};const c=new Date,ga="https://cors.louis.workers.dev?apiurl=",K="https://ewa.epfl.ch/room/Default.aspx?room=",L=new Intl.DateTimeFormat("ch-fr",{hour:"2-digit",minute:"2-digit"}).format,ha=new Date(c.getTime()+864e5),ia=36e5,ja=96e4;function h(e){return new Date(e+"+02:00")}function ka({name:e,loaded:$}){const[r,t]=i({isLoading:!0,freeUntil:null,occupiedUntil:null});Z(()=>{!async function(){const r=await fa(`${ga}${K}${e}`);if($(),!r||!r.length)return;const a=r.split("\n").find(e=>e.includes("v.events")).replace("v.events = ","").replace(/;/g,"").replace(/\\"/g,"").replace(/<br>/g,"").replace(/ISA - /g,"").replace(/\\/g,""),n=JSON.parse(a),i=n.reduce((e,{Start:$,End:r,Text:t})=>{const a=h($),n=h(r);if(e){const n=new Date(e.End);return new Date(n.getUTCMilliseconds()+ja)>a?{Start:$,End:r,Text:t}:e}if(c>a&&c<n)return{Start:$,End:r,Text:t}},null),f=n.find(({Start:e})=>{const $=h(e);return c<$&&$<ha}),l=!i&&f&&h(f.Start),o=i&&h(i.End),I=i&&"R\xE9servation ponctuelle"===i.Text||f&&"R\xE9servation ponctuelle"===f.Text;t({isLoading:!1,freeUntil:l,occupiedUntil:o,isReservationPonctuelle:I})}()},[]);let a="loading",n="\uD83D\uDD04";return r.isLoading||(a="",n="\uD83D\uDC4D",r.isReservationPonctuelle?(a="available for revisions",n="\uD83D\uDC69\u200D\uD83C\uDFEB"):r.freeUntil?(a=`available until ${L(r.freeUntil)}`,r.freeUntil-c.getTime()<=ia&&(n="\u23F3")):r.occupiedUntil&&(a=`occupied until ${L(r.occupiedUntil)}`,n="\u26D4")),d("tr",null,d("td",null,n),d("td",null,d("strong",null,d("a",{target:"_blank",rel:"noopener noreferrer",href:`${K}${e}`},e.toUpperCase()))),d("td",{class:"text-right fullwidth"},a))}var $={};$={in:["inm10","inm11","inm200","inm201","inm202","inm203","inr113","inr219","inf119","inf211","inf213","inf1","inf2","inf3","inj218"],bc:["bc01","bc02","bc03","bc04","bc05","bc010","bc129","bc229","bc329","bc410","bc420"],co:["co020","co021","co023"]};var n=N($);const M=Object.keys(n.d);function la(){const[o,$]=i("all");let[r,m]=i(0);const e=Object.values(n.d).reduce((o,$)=>o+$.length,0),t=()=>{m(r+=1)};console.log(r),console.log(e);const c=r===e?{opacity:"0"}:{};return d("main",{class:"container"},d("header",{class:"header"},d("h1",{class:"less-margin title text-center"},"rEPFL"),d("h3",{class:"less-margin subtitle text-center"},"find a free room @ EPFL")),d("progress",{class:"rooms-progress",value:r||"0",max:e,style:c},r,"/",e),d("p",{class:"button-list"},["all"].concat(M).map(r=>d(k,{key:r},d("button",{onClick:()=>$(r),class:o===r?"filled":""},r.toUpperCase())," "))),M.map($=>d("div",{key:$,class:"all"!==o&&o!==$&&"hidden"},d("h2",{class:"text-center table-h2"},$.toUpperCase()),d("hr",{class:"table-hr"}),d("table",null,d("tbody",null,n.d[$].map(o=>d(ka,{key:o,name:o,loaded:t})))))),d("footer",{class:"footer"},d("hr",null),d("h5",{class:"less-margin"},"made with \u2764\uFE0F by ",d("a",{href:"https://louismerl.in"},"Louis Merlin")),d("h5",{class:"less-margin"},"using ",d("a",{href:"https://preactjs.com"},"preact")," and ",d("a",{href:"https://concrete.style"},"concrete.css")),d("h5",{class:"less-margin"},"need more rooms ? ",d("a",{href:"https://github.com/louismerlin/repfl/blob/master/src/rooms.json"},"add them")," or ",d("a",{href:"mailto:louis.merlin@epfl.ch"},"email me")),d("h5",{class:"less-margin"},"don't hesitate to ",d("a",{href:"https://github.com/louismerlin/repfl"},"star and/or contribute"))))}X(d(la,null),document.body);return{"Focm":{}};});