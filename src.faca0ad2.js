parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function O(a){return a&&a.__esModule?{d:a.default}:{d:a}}var ja,g,e,P,ka,k={},x=[],Q=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function j(o,e){for(var t in e)o[t]=e[t];return o}function B(o){var e=o.parentNode;e&&e.removeChild(o)}function b(o,e,t){var $,n,r,a,l=arguments;if(e=j({},e),arguments.length>3)for(t=[t],$=3;$<arguments.length;$++)t.push(l[$]);if(null!=t&&(e.children=t),null!=o&&null!=o.defaultProps)for(n in o.defaultProps)void 0===e[n]&&(e[n]=o.defaultProps[n]);return a=e.key,null!=(r=e.ref)&&delete e.ref,null!=a&&delete e.key,f(o,e,a,r)}function f(o,e,t,$){var n={type:o,props:e,key:t,ref:$,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return g.vnode&&g.vnode(n),n}function q(o){return o.children}function y(o){if(null==o||"boolean"==typeof o)return null;if("string"==typeof o||"number"==typeof o)return f(null,o,null,null);if(null!=o.__e||null!=o.__c){var e=f(o.type,o.props,o.key,null);return e.__e=o.__e,e}return o}function m(o,e){this.props=o,this.context=e}function w(o,e){if(null==e)return o.__p?w(o.__p,o.__p.__k.indexOf(o)+1):null;for(var t;e<o.__k.length;e++)if(null!=(t=o.__k[e])&&null!=t.__e)return t.__e;return"function"==typeof o.type?w(o):null}function p(o){var e,t;if(null!=(o=o.__p)&&null!=o.__c){for(o.__e=o.__c.base=null,e=0;e<o.__k.length;e++)if(null!=(t=o.__k[e])&&null!=t.__e){o.__e=o.__c.base=t.__e;break}return p(o)}}function n(o){!o.__d&&(o.__d=!0)&&1===e.push(o)&&(g.debounceRendering||P)(R)}function R(){var o;for(e.sort(function(o,e){return e.__v.__b-o.__v.__b});o=e.pop();)o.__d&&o.forceUpdate(!1)}function C(o,e,t,$,n,r,a,l){var p,_,i,u,s,c,S,v,f=e.__k||z(e.props.children,e.__k=[],y,!0),d=t&&t.__k||x,h=d.length;for(l==k&&(l=null!=r?r[0]:h?w(t,0):null),_=0;_<f.length;_++)if(null!=(p=f[_]=y(f[_]))){if(p.__p=e,p.__b=e.__b+1,null===(u=d[_])||u&&p.key==u.key&&p.type===u.type)d[_]=void 0;else for(i=0;i<h;i++){if((u=d[i])&&p.key==u.key&&p.type===u.type){d[i]=void 0;break}u=null}if(s=A(o,p,u=u||k,$,n,r,a,null,l),(i=p.ref)&&u.ref!=i&&(v||(v=[])).push(i,p.__c||s,p),null!=s){if(null==S&&(S=s),null!=p.l)s=p.l,p.l=null;else if(r==u||s!=l||null==s.parentNode)o:if(null==l||l.parentNode!==o)o.appendChild(s);else{for(c=l,i=0;(c=c.nextSibling)&&i<h;i+=2)if(c==s)break o;o.insertBefore(s,l)}l=s.nextSibling,"function"==typeof e.type&&(e.l=s)}}if(e.__e=S,null!=r&&"function"!=typeof e.type)for(_=r.length;_--;)null!=r[_]&&B(r[_]);for(_=h;_--;)null!=d[_]&&F(d[_],d[_]);if(v)for(_=0;_<v.length;_++)E(v[_],v[++_],v[++_])}function z(o,e,t,$){if(null==e&&(e=[]),null==o||"boolean"==typeof o)$&&e.push(null);else if(Array.isArray(o))for(var n=0;n<o.length;n++)z(o[n],e,t,$);else e.push(t?t(o):o);return e}function S(o,e,t,$,n){var r;for(r in t)r in e||u(o,r,null,t[r],$);for(r in e)n&&"function"!=typeof e[r]||"value"===r||"checked"===r||t[r]===e[r]||u(o,r,e[r],t[r],$)}function s(o,e,t){"-"===e[0]?o.setProperty(e,t):o[e]="number"==typeof t&&!1===Q.test(e)?t+"px":t}function u(o,e,t,$,n){var r,a,l,p,_;if("key"===(e=n?"className"===e?"class":e:"class"===e?"className":e)||"children"===e);else if("style"===e){if(r=o.style,"string"==typeof t)r.cssText=t;else{if("string"==typeof $&&(r.cssText="",$=null),$)for(a in $)t&&a in t||s(r,a,"");if(t)for(l in t)$&&t[l]===$[l]||s(r,l,t[l])}}else if("o"===e[0]&&"n"===e[1])p=e!==(e=e.replace(/Capture$/,"")),_=e.toLowerCase(),e=(_ in o?_:e).slice(2),t?($||o.addEventListener(e,v,p),(o.u||(o.u={}))[e]=t):o.removeEventListener(e,v,p);else if("list"!==e&&"tagName"!==e&&!n&&e in o){if(o.length&&"value"==e)for(e=o.length;e--;)o.options[e].selected=o.options[e].value==t;else o[e]=null==t?"":t;}else"function"!=typeof t&&"dangerouslySetInnerHTML"!==e&&(e!==(e=e.replace(/^xlink:?/,""))?null==t||!1===t?o.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):o.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),t):null==t||!1===t?o.removeAttribute(e):o.setAttribute(e,t))}function v(o){return this.u[o.type](g.event?g.event(o):o)}function A(o,e,t,$,n,r,a,l,p){var _,i,u,s,c,S,v,f,d,h,x=e.type;if(void 0!==e.constructor)return null;(_=g.__b)&&_(e);try{o:if("function"==typeof x){if(f=e.props,d=(_=x.contextType)&&$[_.__c],h=_?d?d.props.value:_.__p:$,t.__c?v=(i=e.__c=t.__c).__p=i.__E:(x.prototype&&x.prototype.render?e.__c=i=new x(f,h):(e.__c=i=new m(f,h),i.constructor=x,i.render=U),d&&d.sub(i),i.props=f,i.state||(i.state={}),i.context=h,i.__n=$,u=i.__d=!0,i.__h=[]),null==i.__s&&(i.__s=i.state),null!=x.getDerivedStateFromProps&&j(i.__s==i.state?i.__s=j({},i.__s):i.__s,x.getDerivedStateFromProps(f,i.__s)),u)null==x.getDerivedStateFromProps&&null!=i.componentWillMount&&i.componentWillMount(),null!=i.componentDidMount&&a.push(i);else{if(null==x.getDerivedStateFromProps&&null==l&&null!=i.componentWillReceiveProps&&i.componentWillReceiveProps(f,h),!l&&null!=i.shouldComponentUpdate&&!1===i.shouldComponentUpdate(f,i.__s,h)){i.props=f,i.state=i.__s,i.__d=!1,i.__v=e,e.__e=t.__e,e.__k=t.__k;break o}null!=i.componentWillUpdate&&i.componentWillUpdate(f,i.__s,h)}for(s=i.props,c=i.state,i.context=h,i.props=f,i.state=i.__s,(_=g.__r)&&_(e),i.__d=!1,i.__v=e,i.__P=o,z(null!=(_=i.render(i.props,i.state,i.context))&&_.type==q&&null==_.key?_.props.children:_,e.__k=[],y,!0),null!=i.getChildContext&&($=j(j({},$),i.getChildContext())),u||null==i.getSnapshotBeforeUpdate||(S=i.getSnapshotBeforeUpdate(s,c)),C(o,e,t,$,n,r,a,p),i.base=e.__e;_=i.__h.pop();)_.call(i);u||null==s||null==i.componentDidUpdate||i.componentDidUpdate(s,c,S),v&&(i.__E=i.__p=null)}else e.__e=T(t.__e,e,t,$,n,r,a);(_=g.diffed)&&_(e)}catch(o){g.__e(o,e,t)}return e.__e}function D(o,e){for(var t;t=o.pop();)try{t.componentDidMount()}catch(o){g.__e(o,t.__v)}g.__c&&g.__c(e)}function T(o,e,t,$,n,r,a){var l,p,_,i,u=t.props,s=e.props;if(n="svg"===e.type||n,null==o&&null!=r)for(l=0;l<r.length;l++)if(null!=(p=r[l])&&(null===e.type?3===p.nodeType:p.localName===e.type)){o=p,r[l]=null;break}if(null==o){if(null===e.type)return document.createTextNode(s);o=n?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type),r=null}return null===e.type?u!==s&&(o.data=s):e!==t&&(null!=r&&(r=x.slice.call(o.childNodes)),_=(u=t.props||k).dangerouslySetInnerHTML,i=s.dangerouslySetInnerHTML,null==r&&(i||_)&&(i&&_&&i.__html==_.__html||(o.innerHTML=i&&i.__html||"")),S(o,s,u,n,null!=r),i||C(o,e,t,$,"foreignObject"!==e.type&&n,r,a,k),null==r&&("value"in s&&void 0!==s.value&&s.value!==o.value&&(o.value=null==s.value?"":s.value),"checked"in s&&void 0!==s.checked&&s.checked!==o.checked&&(o.checked=s.checked))),o}function E(o,e,t){try{"function"==typeof o?o(e):o.current=e}catch(o){g.__e(o,t)}}function F(o,e,t){var $,n,r;if(g.unmount&&g.unmount(o),($=o.ref)&&E($,null,e),t||"function"==typeof o.type||(t=null!=(n=o.__e)),o.__e=o.l=null,null!=($=o.__c)){if($.componentWillUnmount)try{$.componentWillUnmount()}catch(o){g.__e(o,e)}$.base=$.__P=null}if($=o.__k)for(r=0;r<$.length;r++)$[r]&&F($[r],e,t);null!=n&&B(n)}function U(o,e,t){return this.constructor(o,t)}function V(o,e,t){var $,n;g.__p&&g.__p(o,e),$=t&&t.__k||e.__k,o=b(q,null,[o]),n=[],A(e,(t||e).__k=o,$||k,k,void 0!==e.ownerSVGElement,t?[t]:$?null:x.slice.call(e.childNodes),n,!1,t||k),D(n,o)}ja=g={},m.prototype.setState=function(o,e){var t=this.__s!==this.state&&this.__s||(this.__s=j({},this.state));("function"!=typeof o||(o=o(t,this.props)))&&j(t,o),null!=o&&this.__v&&(e&&this.__h.push(e),n(this))},m.prototype.forceUpdate=function(o){var e,t,$,n=this.__v,r=this.__v.__e,a=this.__P;a&&(e=!1!==o,t=[],$=A(a,n,j({},n),this.__n,void 0!==a.ownerSVGElement,null,t,e,null==r?w(n):r),D(t,n),$!=r&&p(n)),o&&o()},m.prototype.render=q,e=[],P="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,g.__e=function(o,e,t){for(var $;e=e.__p;)if(($=e.__c)&&!$.__p)try{if($.constructor&&null!=$.constructor.getDerivedStateFromError)$.setState($.constructor.getDerivedStateFromError(o));else{if(null==$.componentDidCatch)continue;$.componentDidCatch(o)}return n($.__E=$)}catch(e){o=e}throw o},ka=0;var o,a,r=[],t=g.__r;g.__r=function($){t&&t($),o=0,(a=$.__c).__H&&(a.__H.t=i(a.__H.t))};var G=g.diffed;g.diffed=function($){G&&G($);var r=$.__c;if(r){var e=r.__H;e&&(e.u=i(e.u))}};var H=g.unmount;function I($){g.__h&&g.__h(a);var r=a.__H||(a.__H={i:[],t:[],u:[]});return $>=r.i.length&&r.i.push({}),r.i[$]}function h($){return W(J,$)}function W($,r,e){var t=I(o++);return t.__c||(t.__c=a,t.o=[e?e(r):J(null,r),function(r){var e=$(t.o[0],r);t.o[0]!==e&&(t.o[0]=e,t.__c.setState({}))}]),t.o}function X($,r){var e=I(o++);ba(e.v,r)&&(e.o=$,e.v=r,a.__H.t.push(e),Y(a))}g.unmount=function($){H&&H($);var r=$.__c;if(r){var e=r.__H;e&&e.i.forEach(function($){return $.p&&$.p()})}};var Y=function(){};function Z(){r.some(function($){$.l=!1,$.__P&&($.__H.t=i($.__H.t))}),r=[]}function i($){return $.forEach(_),$.forEach(aa),[]}function _($){$.p&&$.p()}function aa($){var r=$.o();"function"==typeof r&&($.p=r)}function ba($,r){return!$||r.some(function(r,e){return r!==$[e]})}function J($,r){return"function"==typeof r?r($):r}"undefined"!=typeof window&&(Y=function($){!$.l&&($.l=!0)&&1===r.push($)&&(g.requestAnimationFrame||function($){var r=function(){clearTimeout(e),cancelAnimationFrame(t),setTimeout($)},e=setTimeout(r,100),t=requestAnimationFrame(r)})(Z)});function K(e,t){return new Error(e+" "+t.status+" "+t.responseText)}var ca=function(e,t){return new Promise(function(r,n){var o=t&&t.method||"GET",a=t&&t.body||null,s=t&&t.type||null;e||n(new Error("No url was given"));var u=new XMLHttpRequest;u.open(o,e,!0),a instanceof FormData||"form-data"===s?u.setRequestHeader("Content-Type","multipart/form-data"):null!==a&&"object"==typeof a||"json"===s?("object"==typeof a&&(a=JSON.stringify(a)),u.setRequestHeader("Content-Type","application/json")):u.setRequestHeader("Content-Type",s||"application/x-www-form-urlencoded"),u.onload=function(){if(u.status>=200&&u.status<400)try{var e=JSON.parse(u.responseText);r(e)}catch(t){r(u.responseText)}else n(K("Server returned:",u))},u.onerror=function(){n(K("Connection error:",u))},u.send(a)})};const c=new Date,da="https://cors.louismerl.in",L="https://ewa.epfl.ch/room/Default.aspx?room=",M=new Intl.DateTimeFormat("ch-fr",{hour:"2-digit",minute:"2-digit"}).format,ea=new Date(c.getTime()+864e5),fa=36e5,ga=96e4;function d(e){return new Date(e+"+02:00")}function ha({name:e,loaded:$}){const[t,r]=h({isLoading:!0,freeUntil:null,occupiedUntil:null});X(()=>{!async function(){const t=await ca(`${da}/${L}${e}`);$();const a=t.split("\n").find(e=>e.includes("v.events")).replace("v.events = ","").replace(/;/g,"").replace(/\\"/g,"").replace(/<br>/g,"").replace(/ISA - /g,"").replace(/\\/g,""),n=JSON.parse(a),i=n.reduce((e,{Start:$,End:t,Text:r})=>{const a=d($),n=d(t);if(e){const n=new Date(e.End);return new Date(n.getUTCMilliseconds()+ga)>a?{Start:$,End:t,Text:r}:e}if(c>a&&c<n)return{Start:$,End:t,Text:r}},null),f=n.find(({Start:e})=>{const $=d(e);return c<$&&$<ea}),l=!i&&f&&d(f.Start),o=i&&d(i.End),I=i&&"R\xE9servation ponctuelle"===i.Text||f&&"R\xE9servation ponctuelle"===f.Text;r({isLoading:!1,freeUntil:l,occupiedUntil:o,isReservationPonctuelle:I})}()},[]);let a="loading",n="\uD83D\uDD04";return t.isLoading||(a="",n="\uD83D\uDC4D",t.isReservationPonctuelle?(a="available for revisions",n="\uD83D\uDC69\u200D\uD83C\uDFEB"):t.freeUntil?(a=`available until ${M(t.freeUntil)}`,t.freeUntil-c.getTime()<=fa&&(n="\u23F3")):t.occupiedUntil&&(a=`occupied until ${M(t.occupiedUntil)}`,n="\u26D4")),b("tr",null,b("td",null,n),b("td",null,b("strong",null,b("a",{target:"_blank",href:`${L}${e}`},e.toUpperCase()))),b("td",{class:"text-right fullwidth"},a))}var $={};$={in:["inm10","inm11","inm200","inm201","inm202","inm203","inr113","inr219","inf119","inf211","inf213","inf1","inf2","inf3","inj218"],bc:["bc01","bc02","bc03","bc04","bc05","bc010","bc129","bc229","bc329","bc410","bc420"],co:["co020","co021","co023"]};var l=O($);const N=Object.keys(l.d);function ia(){const[o,$]=h("all");let[r,m]=h(0);const e=Object.values(l.d).reduce((o,$)=>o+$.length,0),c=()=>{m(r+=1)},t=r===e?{opacity:0}:{};return b("main",{class:"container"},b("header",{class:"header"},b("h1",{class:"less-margin title"},"rEPFL"),b("h3",{class:"less-margin"},"find a free room @ EPFL")),b("progress",{class:"rooms-progress",value:r||"0",max:e,style:t},r,"/",e),b("p",{class:"button-list"},["all"].concat(N).map(r=>b(q,null,b("button",{onClick:()=>$(r),class:o===r?"filled":""},r.toUpperCase())," "))),N.map($=>b("div",{class:"all"!==o&&o!==$&&"hidden"},b("h2",{class:"text-center table-h2"},$.toUpperCase()),b("hr",{class:"table-hr"}),b("table",null,b("tbody",null,l.d[$].map(o=>b(ha,{key:o,name:o,loaded:c})))))),b("footer",{class:"footer"},b("hr",null),b("h5",{class:"less-margin"},"made with \u2764\uFE0F by ",b("a",{href:"https://louismerl.in"},"Louis Merlin")),b("h5",{class:"less-margin"},"using ",b("a",{href:"https://preactjs.com"},"preact")," and ",b("a",{href:"https://concrete.style"},"concrete.css")),b("h5",{class:"less-margin"},"need more rooms ? ",b("a",{href:"https://github.com/louismerlin/repfl/blob/master/src/rooms.json"},"add them")," or ",b("a",{href:"mailto:louis.merlin@epfl.ch"},"email me")),b("h5",{class:"less-margin"},"don't hesitate to ",b("a",{href:"https://github.com/louismerlin/repfl"},"star and/or contribute"))))}V(b(ia,null),document.body);return{"Focm":{}};});